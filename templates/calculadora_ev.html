<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calculadora EV - LoL eStats</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-light">

    <!-- Incluimos el navbar -->
    {% include 'navbar.html' %}

    <div class="container py-4">
        <h1 class="mb-4">Calculadora EV</h1>

        <form id="evForm" onsubmit="event.preventDefault(); calcularEV();">
            <div class="mb-3">
                <label for="cuota" class="form-label">Cuota (decimal):</label>
                <input type="number" step="0.01" min="1" id="cuota" class="form-control" placeholder="Ejemplo: 2.5" required value="2.5">
            </div>
            <div class="mb-3">
                <label for="prob" class="form-label">Probabilidad (%):</label>
                <input type="number" step="0.01" min="0" max="100" id="prob" class="form-control" placeholder="Ejemplo: 60" required value="60">
            </div>
            <button type="submit" class="btn btn-warning"><i class="fa-solid fa-calculator me-1"></i>Calcular EV</button>
        </form>

        <div class="mt-4">
            <p id="resultado" class="fs-5"></p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
    function calcularEV() {
        const cuota = parseFloat(document.getElementById('cuota').value);
        const probPorc = parseFloat(document.getElementById('prob').value);
        const prob = probPorc / 100;
        const resultadoElem = document.getElementById('resultado');

        if (isNaN(cuota) || isNaN(prob) || cuota < 1 || prob < 0 || prob > 1) {
            resultadoElem.textContent = 'Por favor ingresa valores válidos.';
            resultadoElem.classList.remove('text-success');
            resultadoElem.classList.add('text-danger');
            return;
        }

        fetch(`/calculadora_ev?cuota=${cuota}&prob=${prob}`)
            .then(response => response.json())
            .then(data => {
                if (data.ev !== undefined) {
                    const ev = data.ev;
                    resultadoElem.textContent = `EV: ${ev.toFixed(4)}`;
                    resultadoElem.classList.remove('text-danger');
                    resultadoElem.classList.add('text-success');
                } else if (data.error) {
                    resultadoElem.textContent = 'Error: ' + data.error;
                    resultadoElem.classList.remove('text-success');
                    resultadoElem.classList.add('text-danger');
                }
            })
            .catch(err => {
                resultadoElem.textContent = 'Error en la conexión.';
                resultadoElem.classList.remove('text-success');
                resultadoElem.classList.add('text-danger');
                console.error(err);
            });
    }
    </script>
</body>
</html>
